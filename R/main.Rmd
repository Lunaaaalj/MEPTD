---
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = FALSE)

```


Juntando todos los datos de todos los años, se obtiene infofmacion relevante sobre la base de datos

# Estructura:


```{r}
# Set working directory to the correct folder (Datos, not data)
#setwd("/Users/angelluna/Documents/STEM_PROJECTS/R_Projects_2/MEPTD/data")

# Set working directory (Rafael)
setwd("/Users/hisen/OneDrive/Documentos/ProyectosR_Estadistica3ro/MEPTD/Data")

# Install and load required library for combining data frames
if (!require(dplyr, quietly = TRUE)) {
  install.packages("dplyr")
  library(dplyr)
}

if(!require(ggplot2, quietly = TRUE)) {
  install.packages("ggplot2")
  library(ggplot2)
}

# Para las medidas de forma 
if(!require(moments, quietly = TRUE)) {
  install.packages("moments")
  library(moments)
}

# Read CSV files individually first
df_2019 <- read.csv("conjunto_de_datos_molec_2019_02.csv")
df_2020 <- read.csv("conjunto_de_datos_molec_2020_02.csv")
df_2021 <- read.csv("conjunto_de_datos_molec_2021_02.CSV")
df_2022 <- read.csv("conjunto_de_datos_molec_2022_02.CSV")
df_2023 <- read.csv("conjunto_de_datos_molec_2023_02.CSV")
df_2024 <- read.csv("conjunto_de_datos_molec_2024_02.csv")

# Combine data frames properly using rbind() or bind_rows()
df <- bind_rows(df_2019, df_2020, df_2021, df_2022, df_2023, df_2024)

# Display column names using cat() (preferred) or print()

# clean the data frame

df_c = df[,c(4,104,105,107,85,86,87,89,11,17,18,33,34,52,53)]

str(df_c)

# Alternative: just use print() properly
# print(colnames(df))
# Hola, este es mi cambio
# Segundo cambio
```


# Dimensión del data frame

Para encontrar la cantidad de columnas y renglones del data frame se usan las funciones de ncol y nrow

```{r}
ncol(df_c)
nrow(df_c)
```


# Datos faltantes

Variables selectionadas:

```{r}
head(df_c)
```

Analizando el sumario, no se notan discrepancias en los valores

```{r}
summary(df_c)
```

No hay valores vacios

```{r}
colSums(is.na(df_c))
```

Chequeo de rango de los datos cuantitativos

Edad:

```{r}
subset(df_c,edad <0)
subset(df_c,edad>99)
```

Cantidad de libros leidos:

```{r}
subset(df_c,p4<0)
subset(df_c,p4>70)
```

Revistas:

```{r}
subset(df_c,p10<0)
subset(df_c,p10>25)
```

Periodicos:

```{r}
subset(df_c,p16<0)
subset(df_c,p16>60)
```

Conclusion: no hay discrepancias en la base de datos que podrian afectar el analisis

Prepararemos los datos para tener un mejor analisis, esto requiere que se combinen las columnas de la cantidad de libros, revistas y periodicos leidos en una sola columna mas general:

```{r}
df_c$TL=(df_c$p4+df_c$p10+df_c$p16)
head(df_c)
```


# Descripción de variables

# A. Exploracion de datos

## 1. Calculo de medias estadisticas

### Variables cuantitativas
```{r}
# ----MEDIDAS DE TENDENCIA CENTRAL----

# Media
media_edad = mean(df_c$edad)
media_p4 = mean(df_c$p4)
media_p10 = mean(df_c$p10)
media_p16 = mean(df_c$p16)
media_TL = mean(df_c$TL)
# Mediana
mediana_edad = median(df_c$edad)
mediana_p4 = median(df_c$p4)
mediana_p10 = median(df_c$p10)
mediana_p16 = median(df_c$p16)
mediana_TL = median(df_c$TL)
# Rango medio
rm_edad = (min(df_c$edad)+max(df_c$edad))/2
rm_p4 = (min(df_c$p4)+max(df_c$p4))/2
rm_p10 = (min(df_c$p10)+max(df_c$p10))/2
rm_p16 = (min(df_c$p16)+max(df_c$p16))/2
rm_TL = (min(df_c$TL)+max(df_c$TL))/2

# Generamos una tabla que nos da el resumen final de las medidas de tendencia central
resumen_tendencia_central = data.frame(
nombreVariable = c("Edad", "Libros(p4)", "Revistas(p10)", "Periódicos(p16)", "Total leído(TL)"),
media = c(media_edad, media_p4, media_p10, media_p16, media_TL),
mediana = c(mediana_edad, mediana_p4, mediana_p10, mediana_p16, mediana_TL),
rangoMedio = c(rm_edad, rm_p4, rm_p10, rm_p16, rm_TL)
)

# ----MEDIDAS DE DISPERSIÓN----

# Desviación estándar
sd_edad = sd(df_c$edad)
sd_p4 = sd(df_c$p4)
sd_p10 = sd(df_c$p10)
sd_p16 = sd(df_c$p16)
sd_TL = sd(df_c$TL)
# Varianza
var_edad = var(df_c$edad)
var_p4 = var(df_c$p4)
var_p10 = var(df_c$p10)
var_p16 = var(df_c$p16)
var_TL = var(df_c$TL)
# Coeficiente de variación
coefvar_edad = (sd(df_c$edad)/mean(df_c$edad))*100
coefvar_p4 = (sd(df_c$p4)/mean(df_c$p4))*100
coefvar_p10 = (sd(df_c$p10)/mean(df_c$p10))*100
coefvar_p16 = (sd(df_c$p16)/mean(df_c$p16))*100
coefvar_TL = (sd(df_c$TL)/mean(df_c$TL))*100

# Generamos una tabla que nos da el resumen final de las medidas de dispersión
resumen_dispersion = data.frame(
nombreVariable = c("Edad", "Libros(p4)", "Revistas(p10)", "Periódicos(p16)", "Total leído(TL)"),
desviacionEstandar = c(sd_edad, sd_p4, sd_p10, sd_p16, sd_TL),
varianza = c(var_edad, var_p4, var_p10, var_p16, var_TL),
coefVariacion = c(coefvar_edad, coefvar_p4, coefvar_p10, coefvar_p16, coefvar_TL)
)

# ----MEDIDAS DE POSICIÓN----

# Cuartil 1
Q1_edad = quantile(df_c$edad, probs = 0.25)
Q1_p4 = quantile(df_c$p4, probs = 0.25)
Q1_p10 = quantile(df_c$p10, probs = 0.25)
Q1_p16 = quantile(df_c$p16, probs = 0.25)
Q1_TL = quantile(df_c$TL, probs = 0.25)

# Cuartil 2
Q2_edad = quantile(df_c$edad, probs = 0.5)
Q2_p4 = quantile(df_c$p4, probs = 0.5)
Q2_p10 = quantile(df_c$p10, probs = 0.5)
Q2_p16 = quantile(df_c$p16, probs = 0.5)
Q2_TL = quantile(df_c$TL, probs = 0.5)

# Cuartil 1
Q3_edad = quantile(df_c$edad, probs = 0.75)
Q3_p4 = quantile(df_c$p4, probs = 0.75)
Q3_p10 = quantile(df_c$p10, probs = 0.75)
Q3_p16 = quantile(df_c$p16, probs = 0.75)
Q3_TL = quantile(df_c$TL, probs = 0.75)

# Generamos una tabla que nos da el resumen final de las medidas de posición
resumen_posicion = data.frame(
nombreVariable = c("Edad", "Libros(p4)", "Revistas(p10)", "Periódicos(p16)", "Total leído(TL)"),
Q1_0.25 = c(Q1_edad, Q1_p4, Q1_p10, Q1_p16, Q1_TL),
Q2_0.5 = c(Q2_edad, Q2_p4, Q2_p10, Q2_p16, Q2_TL),
Q3_0.75 = c(Q3_edad, Q3_p4, Q3_p10, Q3_p16, Q3_TL)
)

# ----MEDIDAS DE FORMA----

# Sesgo
sesgo_edad = skewness(df_c$edad)
sesgo_p4 = skewness(df_c$p4)
sesgo_p10 = skewness(df_c$p10)
sesgo_p16 = skewness(df_c$p16)
sesgo_TL = skewness(df_c$TL)

#Curtosis
curtosis_edad = kurtosis(df_c$edad)
curtosis_p4 = kurtosis(df_c$p4)
curtosis_p10 = kurtosis(df_c$p10)
curtosis_p16 = kurtosis(df_c$p16)
curtosis_TL = kurtosis(df_c$TL)

# Generamos una tabla que nos da el resumen final de las medidas de forma
resumen_medidas_forma = data.frame(
nombreVariable = c("Edad", "Libros(p4)", "Revistas(p10)", "Periódicos(p16)", "Total leído(TL)"),
Sesgo = c(sesgo_edad, sesgo_p4, sesgo_p10, sesgo_p16, sesgo_TL),
Curtosis = c(curtosis_edad, curtosis_p4, curtosis_p10, curtosis_p16, curtosis_TL)
)

# ----IMPRIMIR RESULTADOS----

#Imprimimos el resumen de las medidas de tendencia central
print(resumen_tendencia_central)
#Imprimimos el resumen de las medidas de dispersión
print(resumen_dispersion)
#Imprimimos el resumen de las medidas de posición
print(resumen_posicion)
#Imprimimos el resumen de las medidas de forma
print(resumen_medidas_forma)

```

### Variables cualitativas

## Herramientas de visualizacion

### Variables cuantitativas

Grafica de dispersion: Textos leidos vs edad

```{r}
ggplot(data = df_c[,c("edad","TL")], aes(x=edad,y=TL)) +
        geom_jitter(size = 0.9)
```


Gran cantidad de valores atipicos, mayor densidad cerca del 0, se nota una baja o nula coorrelacion debido a que es constante cerca del cero




Grafica de barras: Textos leidos vs cantidad de gente



```{r}
ggplot(data = df_c[,c("edad","TL")], aes(x=TL)) +
        geom_bar() +
        stat_function(fun = dnorm,args = list(mean = mean(df_c$TL), sd = sd(df_c$TL)), linewidth = 1) +
        xlim(0,30) +
        ylim(0,1500) +
        geom_vline(xintercept =mean(df_c$TL), aes(x = TL),color = "red",linewidth=1.3)
```


Densidad de cantidad de libros leidos

```{r}
ggplot(data = df_c, aes(x = TL)) +
        geom_density(alpha= 1) +
        xlim(0,50)
```


Distribucion asimetrica con sesgo a la izquierda

Boxplot:

```{r}
ggplot(data = df_c, aes(x = TL, y = edad)) +
        geom_boxplot(fill = "red") +
        geom_point(alpha = 0.3)
```

### Análisis de coorrelacion



### Variables categoricas

# Vinculacion de datos categoricos

## Medidas de variables cuantitativas

## Graficos cuantitativos

## Graficos comparativos




















